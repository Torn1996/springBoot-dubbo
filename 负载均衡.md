### 一、负载均衡:

### 	4种负载均衡策略

```properties
 Random LoadBalance

	随机，按权重设置随机概率。默认策略

 RoundRobin LoadBalance

	轮询，按公约后的权重设置轮询比率

 LeastActive LoadBalance

	最少活跃调用数，相同活跃数的随机，活跃数指调用前后计数差

 ConsistentHash LoadBalance

	一直Hash，相同参数的请求总是发给同一个提供者

	配置策略时可以在服务提供方（@Service注解）与消费方（@Reference注解）修改LoadBalance参数，也可以在dubbo-admin中使用 图形化界面完成配置。dubbo-admin>@Referenc>@Service
```

### 二、服务降级

​	为了避免由一个服务崩溃而引起连锁反应以及保持主业务的正常运行，可以对服务器进行降级处理，在调用失败后返回默认数据。

​	dubbo通过mock实现服务降级，并提供了两种配置方式：

#### 		简单降级：

```properties
	设置服务消费方@Reference注解的mock参数为return null，表示当前远程调用失败直接返回null，或返回其他默认值。
	@Reference（mock=“return null”）
	private IHello hello；
```

#### 		复杂降级：

```properties
	mock可以指定一个具体的类，当调用失败时执行，以满足复杂的业务逻辑。
	@Service（mock=“IHelloMock”）
	@Reference（mock=”true“）
```

### 三、集群容错

​	在服务调用失败或超时时，dubbo可以配置多种策略重新调用集群中的其他服务提供方。

​	在提供方的@Service和消费方的@Reference注解中配置cluster参数，或者用application.properties中的dubbo.service.cluster参数来指定容错的策略。

```properties
FailOver Cluster：失败自动切换，默认的，通常用于读操作，重试会带来更长的延迟，可以配置重试次数。

Failfast Cluster：快速失败，只发起一次调用，通常用于非幂等操作。
	幂等操作指的是：多次调用的结果和一次调用的结果是一样的，例如删除操作，更新操作，添加操作
	非幂等操作则反之，例如插入操作
Failsafe Cluster：失败安全，出现异常直接忽略。通常用于记录日志。

Failback Cluster：失败自动恢复，通常用于消息通知操作。

ForKing Cluster：并行调用多个服务器，只要一个成功返回即可以。

Broadcast Cluster：广播调用所有提供者，逐个调用，任意一台报错则报错。
```

